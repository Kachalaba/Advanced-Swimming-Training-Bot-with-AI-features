# üéØ –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ—Å–∫–∞–∫–∏–≤–∞–Ω–∏—è –Ω–∞ –¥—Ä—É–≥–∏—Ö –ª—é–¥–µ–π

## üêõ –ü—Ä–æ–±–ª–µ–º–∞: –¢—Ä–µ–∫–∏–Ω–≥ "–ø–µ—Ä–µ—Å–∫–∞–∫–∏–≤–∞–µ—Ç" –Ω–∞ –¥—Ä—É–≥–∏—Ö

### –ß—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏–ª–æ:
```
–ö–∞–¥—Ä 1-10:  –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º –ü–õ–û–í–¶–ê (bbox —Å–∏–Ω–∏–π)
–ö–∞–¥—Ä 11:    –í –∫–∞–¥—Ä –∑–∞—à—ë–ª –¢–†–ï–ù–ï–† (bbox –∫—Ä–∞—Å–Ω—ã–π) ‚Üê –¥—Ä—É–≥–æ–π —á–µ–ª–æ–≤–µ–∫!
–ö–∞–¥—Ä 12:    –¢—Ä–µ–∫–µ—Ä –ü–ï–†–ï–°–ö–ê–ö–ò–í–ê–ï–¢ –Ω–∞ —Ç—Ä–µ–Ω–µ—Ä–∞! ‚ùå
–ö–∞–¥—Ä 13-20: –û—Ç—Å–ª–µ–∂–∏–≤–∞–µ–º —Ç—Ä–µ–Ω–µ—Ä–∞ –≤–º–µ—Å—Ç–æ –ø–ª–æ–≤—Ü–∞ ‚ùå
```

**–ü—Ä–∏—á–∏–Ω—ã:**
- YOLO –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç –í–°–ï–• –ª—é–¥–µ–π –≤ –∫–∞–¥—Ä–µ
- –°–∏—Å—Ç–µ–º–∞ –Ω–µ –∑–Ω–∞–µ—Ç –∫—Ç–æ "–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π" –æ–±—ä–µ–∫—Ç
- –ü–µ—Ä–µ—Å–∫–∞–∫–∏–≤–∞–µ—Ç –Ω–∞ –±–ª–∏–∂–∞–π—à–∏–π/–±–æ–ª—å—à–∏–π bbox
- –¢–µ—Ä—è–µ—Ç —Ü–µ–ª–µ–≤–æ–≥–æ –ø–ª–æ–≤—Ü–∞

---

## ‚úÖ –†–µ—à–µ–Ω–∏–µ: Strict Object Tracking (–°—Ç—Ä–æ–≥–∏–π —Ç—Ä–µ–∫–∏–Ω–≥)

###  –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:

#### 1. **–£–≤–µ–ª–∏—á–µ–Ω—ã –≤–µ—Å–∞ IoU –∏ Distance** (–≥–ª–∞–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏!)
```python
# –ë—ã–ª–æ:
iou * 3.0        # IoU weight
dist_score * 2.0  # Distance weight

# –°—Ç–∞–ª–æ:
iou * 10.0       # IoU weight ‚Üê x3 —É–≤–µ–ª–∏—á–µ–Ω–æ!
dist_score * 5.0  # Distance weight ‚Üê x2.5 —É–≤–µ–ª–∏—á–µ–Ω–æ!
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–∏—Å—Ç–µ–º–∞ —Å–∏–ª—å–Ω–æ –ø—Ä–µ–¥–ø–æ—á–∏—Ç–∞–µ—Ç –æ–±—ä–µ–∫—Ç –Ω–∞ —Ç–æ–º –∂–µ –º–µ—Å—Ç–µ

#### 2. **–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ bbox**
```python
# –ü–ª–æ—â–∞–¥—å bbox (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ—Ö–æ–∂–∞)
area_ratio = min(prev_area, det_area) / max(prev_area, det_area)

# –°–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å—Ç–æ—Ä–æ–Ω (—Ñ–æ—Ä–º–∞ bbox –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –ø–æ—Ö–æ–∂–∞)
aspect_similarity = min(prev_aspect, det_aspect) / max(prev_aspect, det_aspect)

# Bonus –∑–∞ –ø–æ—Ö–æ–∂–∏–π —Ä–∞–∑–º–µ—Ä
size_score = (area_ratio + aspect_similarity) / 2.0
score += size_score * 3.0  # Weight: 3x
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–ª–æ–≤–µ—Ü –∏ —Ç—Ä–µ–Ω–µ—Ä –∏–º–µ—é—Ç —Ä–∞–∑–Ω—ã–µ —Ä–∞–∑–º–µ—Ä—ã ‚Üí —Å–∏—Å—Ç–µ–º–∞ –Ω–µ –ø–µ—Ä–µ—Å–∫–æ—á–∏—Ç

#### 3. **–ñ–µ—Å—Ç–∫–∏–π –ø–æ—Ä–æ–≥ IoU (–∑–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è)**
```python
# –ï—Å–ª–∏ IoU < 20% - —ç—Ç–æ –î–†–£–ì–û–ô –æ–±—ä–µ–∫—Ç!
if best_iou < 0.2 and best_det is not None:
    logger.warning("Low IoU - possible object switch! Keeping previous bbox.")
    # –ù–µ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è - –≤–æ–∑–≤—Ä–∞—â–∞–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π bbox
    return {
        "bbox": prev_bbox,
        "center": prev_center,
        "confidence": 0.5,
        "lane": target_lane,
        "tracking_lost": True  # –ü–æ–º–µ—á–∞–µ–º —á—Ç–æ —Ç—Ä–µ–∫–∏–Ω–≥ –Ω–µ–Ω–∞–¥–µ–∂–µ–Ω
    }
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ï—Å–ª–∏ –Ω–æ–≤—ã–π bbox –Ω–µ –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º –Ω–∞ 20%+, —Å–∏—Å—Ç–µ–º–∞ –ù–ï –ø–µ—Ä–µ–∫–ª—é—á–∏—Ç—Å—è

#### 4. **–£–º–µ–Ω—å—à–µ–Ω –¥–æ–ø—É—Å—Ç–∏–º—ã–π —Å–¥–≤–∏–≥ (150px –≤–º–µ—Å—Ç–æ 200px)**
```python
# –ë—ã–ª–æ: max movement 200px
dist_score = max(0, 1.0 - dist / 200.0)

# –°—Ç–∞–ª–æ: max movement 150px
dist_score = max(0, 1.0 - dist / 150.0)
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–∞–ª—å–Ω–∏–µ –æ–±—ä–µ–∫—Ç—ã (—Ç—Ä–µ–Ω–µ—Ä –Ω–∞ –∫—Ä–∞—é) –ø–æ–ª—É—á–∞—é—Ç –º–µ–Ω—å—à–∏–π score

---

## üìä Scoring System (–°–∏—Å—Ç–µ–º–∞ –æ—Ü–µ–Ω–æ–∫):

### –û–±—â–∏–π score –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞:

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –í–µ—Å | –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç |
|----------|-----|---------------|
| **IoU (overlap)** | 10x | –ù–∞—Å–∫–æ–ª—å–∫–æ bbox –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º |
| **Distance (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ)** | 5x | –ù–∞—Å–∫–æ–ª—å–∫–æ –±–ª–∏–∑–∫–æ center –∫ –ø—Ä–µ–¥—ã–¥—É—â–µ–º—É |
| **Size similarity** | 3x | –ü–æ—Ö–æ–∂–∏–π –ª–∏ —Ä–∞–∑–º–µ—Ä –∏ —Ñ–æ—Ä–º–∞ bbox |
| **Lane consistency** | 2x | –¢–æ—Ç –∂–µ lane (–¥–æ—Ä–æ–∂–∫–∞) |
| **Confidence** | 0.3x | –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å YOLO (–Ω–∏–∑–∫–∏–π –≤–µ—Å!) |

**–ò—Ç–æ–≥–æ:** Max score = 10 + 5 + 3 + 2 + 0.3 = **20.3**

---

## üéØ –ü—Ä–∏–º–µ—Ä—ã —Ä–∞–±–æ—Ç—ã:

### –ü—Ä–∏–º–µ—Ä 1: –ü–ª–æ–≤–µ—Ü –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –ø–ª—ã—Ç—å ‚úÖ

```
–ü—Ä–µ–¥—ã–¥—É—â–∏–π –∫–∞–¥—Ä: –ü–ª–æ–≤–µ—Ü [100, 200, 200, 400]

–¢–µ–∫—É—â–∏–π –∫–∞–¥—Ä:
  –ö–∞–Ω–¥–∏–¥–∞—Ç 1: [105, 205, 205, 405] ‚Üê –ü–ª–æ–≤–µ—Ü (–Ω–µ–º–Ω–æ–≥–æ —Å–¥–≤–∏–Ω—É–ª—Å—è)
  –ö–∞–Ω–¥–∏–¥–∞—Ç 2: [500, 100, 600, 300] ‚Üê –¢—Ä–µ–Ω–µ—Ä (–≤–¥–∞–ª–µ–∫–µ)

Scoring:
  –ö–∞–Ω–¥–∏–¥–∞—Ç 1 (–ü–ª–æ–≤–µ—Ü):
    IoU: 0.95 ‚Üí score += 0.95 * 10 = 9.5
    Distance: 7px ‚Üí score += 0.95 * 5 = 4.75
    Size: 0.98 ‚Üí score += 0.98 * 3 = 2.94
    TOTAL: 17.19 ‚Üê WINNER! ‚úÖ
  
  –ö–∞–Ω–¥–∏–¥–∞—Ç 2 (–¢—Ä–µ–Ω–µ—Ä):
    IoU: 0.0 ‚Üí score += 0
    Distance: 450px ‚Üí score += 0
    Size: 0.5 ‚Üí score += 1.5
    TOTAL: 1.5

–í—ã–±—Ä–∞–Ω: –ö–∞–Ω–¥–∏–¥–∞—Ç 1 (–ü–ª–æ–≤–µ—Ü) ‚úÖ
```

### –ü—Ä–∏–º–µ—Ä 2: –¢—Ä–µ–Ω–µ—Ä –∑–∞—à—ë–ª –≤ –∫–∞–¥—Ä - –ù–ï –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è ‚úÖ

```
–ü—Ä–µ–¥—ã–¥—É—â–∏–π –∫–∞–¥—Ä: –ü–ª–æ–≤–µ—Ü [300, 200, 400, 400]

–¢–µ–∫—É—â–∏–π –∫–∞–¥—Ä:
  –ö–∞–Ω–¥–∏–¥–∞—Ç 1: [305, 205, 405, 405] ‚Üê –ü–ª–æ–≤–µ—Ü
  –ö–∞–Ω–¥–∏–¥–∞—Ç 2: [100, 150, 200, 350] ‚Üê –¢—Ä–µ–Ω–µ—Ä (–∫—Ä—É–ø–Ω–µ–µ!)

Scoring:
  –ö–∞–Ω–¥–∏–¥–∞—Ç 1 (–ü–ª–æ–≤–µ—Ü):
    IoU: 0.92 ‚Üí score += 9.2
    Distance: 7px ‚Üí score += 4.65
    Size: 0.98 ‚Üí score += 2.94
    TOTAL: 16.79 ‚Üê WINNER! ‚úÖ
  
  –ö–∞–Ω–¥–∏–¥–∞—Ç 2 (–¢—Ä–µ–Ω–µ—Ä):
    IoU: 0.0 ‚Üí score += 0
    Distance: 250px ‚Üí score += 0
    Size: 1.2 (–±–æ–ª—å—à–µ –Ω–∞ 20%) ‚Üí score += 2.4
    Confidence: 0.9 ‚Üí score += 0.27
    TOTAL: 2.67

–í—ã–±—Ä–∞–Ω: –ö–∞–Ω–¥–∏–¥–∞—Ç 1 (–ü–ª–æ–≤–µ—Ü) ‚úÖ
+ –ñ–µ—Å—Ç–∫–∏–π –ø–æ—Ä–æ–≥: IoU —Ç—Ä–µ–Ω–µ—Ä–∞ = 0.0 < 0.2 ‚Üí –ë–õ–û–ö–ò–†–û–í–ö–ê!
```

### –ü—Ä–∏–º–µ—Ä 3: –ü–ª–æ–≤–µ—Ü –≤—Ä–µ–º–µ–Ω–Ω–æ –ø—Ä–æ–ø–∞–ª (–ø–æ–¥ –≤–æ–¥–æ–π) ‚úÖ

```
–ü—Ä–µ–¥—ã–¥—É—â–∏–π –∫–∞–¥—Ä: –ü–ª–æ–≤–µ—Ü [300, 200, 400, 400]

–¢–µ–∫—É—â–∏–π –∫–∞–¥—Ä:
  –ö–∞–Ω–¥–∏–¥–∞—Ç 1: [500, 100, 600, 300] ‚Üê –¢—Ä–µ–Ω–µ—Ä (—Ç–æ–ª—å–∫–æ –æ–Ω –¥–µ—Ç–µ–∫—Ç–∏—Ä—É–µ—Ç—Å—è)

Scoring:
  –ö–∞–Ω–¥–∏–¥–∞—Ç 1 (–¢—Ä–µ–Ω–µ—Ä):
    IoU: 0.0 ‚Üí score += 0
    Distance: 280px ‚Üí score += 0
    TOTAL: ~1.0
    
  best_iou = 0.0 < 0.2 ‚Üê –ñ–ï–°–¢–ö–ò–ô –ü–û–†–û–ì!
  
–í—ã–±—Ä–∞–Ω–æ: –ü—Ä–µ–¥—ã–¥—É—â–∏–π bbox –ø–ª–æ–≤—Ü–∞ (—Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏–π) ‚úÖ
–ü–æ–º–µ—á–µ–Ω–æ: tracking_lost = True
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –°–∏—Å—Ç–µ–º–∞ –ù–ï –ø–µ—Ä–µ—Å–∫–∞–∫–∏–≤–∞–µ—Ç, –¥–µ—Ä–∂–∏—Ç –ø—Ä–µ–¥—ã–¥—É—â—É—é –ø–æ–∑–∏—Ü–∏—é –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è –ø–ª–æ–≤—Ü–∞

---

## üîß –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è:

### 1. **–°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏** (window_size=5)
- –£–±–∏—Ä–∞–µ—Ç –¥—Ä–æ–∂–∞–Ω–∏–µ bbox
- –ü–ª–∞–≤–Ω–∞—è —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏—è
- –†–∞–±–æ—Ç–∞–µ—Ç –ü–û–°–õ–ï –∞–Ω—Ç–∏–ø–µ—Ä–µ—Å–∫–∞–∫–∏–≤–∞–Ω–∏—è

### 2. **–ò–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤**
- –ó–∞–ø–æ–ª–Ω—è–µ—Ç –∫–∞–¥—Ä—ã –≥–¥–µ YOLO –Ω–µ –¥–µ—Ç–µ–∫—Ç–∏—Ä–æ–≤–∞–ª
- –õ–∏–Ω–µ–π–Ω–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è –º–µ–∂–¥—É —Å–æ—Å–µ–¥–Ω–∏–º–∏ –∫–∞–¥—Ä–∞–º–∏

### 3. **–£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–π FPS (–¥–æ 20)**
- –ë–æ–ª—å—à–µ –∫–∞–¥—Ä–æ–≤ = –º–µ–Ω—å—à–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å –ø—Ä–æ–ø—É—Å—Ç–∏—Ç—å –ø–ª–æ–≤—Ü–∞
- –¢–æ—á–Ω–µ–µ —Ç—Ä–µ–∫–∏–Ω–≥

---

## üöÄ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å:

### Streamlit:
```bash
cd /Users/nikita/Downloads/Sprint-Bot-main
python3 -m streamlit run app.py
```

**–ù–∞—Å—Ç—Ä–æ–π–∫–∏:**
- FPS: **10-15** (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –º–Ω–æ–≥–æ–ª—é–¥–Ω—ã—Ö –≤–∏–¥–µ–æ)
- Method: **Hybrid**
- –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!

---

### CLI:
```bash
cd /Users/nikita/Downloads/Sprint-Bot-main

PYTHONPATH=$PWD python3 examples/run_local_video_analysis.py \
    --video –≤–∏–¥–µ–æ_—Å_—Ç—Ä–µ–Ω–µ—Ä–æ–º.mp4 \
    --fps 10.0 \
    --analysis-method hybrid \
    --output ./anti–ùump_test
```

---

## üîç –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:

### 1. –ü–æ—Å–º–æ—Ç—Ä–∏ –ª–æ–≥–∏:
```bash
# –î–æ–ª–∂–µ–Ω –≤–∏–¥–µ—Ç—å warnings –∫–æ–≥–¥–∞ –ø–æ—è–≤–ª—è—é—Ç—Å—è –¥—Ä—É–≥–∏–µ –ª—é–¥–∏
cat logs/bot.log | grep -i "Low IoU"
cat logs/bot.log | grep -i "possible object switch"
cat logs/bot.log | grep -i "Tracking score"
```

**–•–æ—Ä–æ—à–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–∏:**
```
WARNING - Low IoU 0.05 - possible object switch! Keeping previous bbox.
DEBUG - Tracking score: 16.5, IoU: 0.92
DEBUG - Tracking score: 17.2, IoU: 0.95
WARNING - Low IoU 0.12 - possible object switch! Keeping previous bbox.
DEBUG - Tracking score: 16.8, IoU: 0.91
```

### 2. –ü–æ—Å–º–æ—Ç—Ä–∏ –≤–∏–¥–µ–æ:
```bash
open ./antijump_test/annotated_video.mp4
```

**–ü—Ä–æ–≤–µ—Ä—å:**
- Bbox –æ—Å—Ç–∞—ë—Ç—Å—è –Ω–∞ –ø–ª–æ–≤—Ü–µ –≤–µ—Å—å –≤–∏–¥–µ–æ ‚úÖ
- –ù–µ –ø–µ—Ä–µ—Å–∫–∞–∫–∏–≤–∞–µ—Ç –Ω–∞ —Ç—Ä–µ–Ω–µ—Ä–∞ ‚úÖ
- –ù–µ –ø–µ—Ä–µ—Å–∫–∞–∫–∏–≤–∞–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏—Ö –ø–ª–æ–≤—Ü–æ–≤ ‚úÖ

### 3. –ü—Ä–æ–≤–µ—Ä—å metadata:
```bash
cat ./antijump_test/detections.json | python3 -c "
import json, sys
data = json.load(sys.stdin)
lost_frames = sum(1 for d in data if d.get('tracking_lost', False))
total = len(data)
print(f'Tracking lost frames: {lost_frames}/{total} ({lost_frames/total*100:.1f}%)')
print('(–≠—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è –∫–∞–¥—Ä–æ–≤ –≥–¥–µ –ø–ª–æ–≤–µ—Ü –ø–æ–¥ –≤–æ–¥–æ–π)')
"
```

---

## üí° –°–æ–≤–µ—Ç—ã:

### 1. –î–ª—è –≤–∏–¥–µ–æ —Å –ú–ù–û–ñ–ï–°–¢–í–û–ú –ª—é–¥–µ–π:
```bash
--fps 15.0  # –ë–æ–ª—å—à–µ –∫–∞–¥—Ä–æ–≤ = –Ω–∞–¥–µ–∂–Ω–µ–µ —Ç—Ä–µ–∫–∏–Ω–≥
```

### 2. –ï—Å–ª–∏ —Å–∏—Å—Ç–µ–º–∞ –≤—Å—ë —Ä–∞–≤–Ω–æ –ø–µ—Ä–µ–∫–ª—é—á–∞–µ—Ç—Å—è:
**–í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:**
- –ü–ª–æ–≤–µ—Ü –û–ß–ï–ù–¨ –±—ã—Å—Ç—Ä–æ –¥–≤–∏–≥–∞–µ—Ç—Å—è (>150px –∑–∞ –∫–∞–¥—Ä)
- –î–≤–∞ –ø–ª–æ–≤—Ü–∞ –ø–µ—Ä–µ—Å–µ–∫–ª–∏—Å—å (–æ–¥–Ω–∞ –¥–æ—Ä–æ–∂–∫–∞)
- –ö–∞–º–µ—Ä–∞ –¥–≤–∏–≥–∞–µ—Ç—Å—è/–¥—Ä–æ–∂–∏—Ç

**–†–µ—à–µ–Ω–∏–µ:**
- –£–≤–µ–ª–∏—á—å FPS (10‚Üí15)
- –ò—Å–ø–æ–ª—å–∑—É–π —Å—Ç–∞–±–∏–ª—å–Ω—É—é –∫–∞–º–µ—Ä—É
- –°–Ω–∏–º–∞–π –æ–¥–Ω—É –¥–æ—Ä–æ–∂–∫—É

### 3. –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:

| –°—Ü–µ–Ω–∞—Ä–∏–π | FPS | –û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç |
|----------|-----|---------------------|
| **–û–¥–∏–Ω –ø–ª–æ–≤–µ—Ü** | 5-10 | 99% –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç—Ä–µ–∫–∏–Ω–≥ |
| **+ –¢—Ä–µ–Ω–µ—Ä –Ω–∞ –∫—Ä–∞—é** | 10 | 95-98% –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π |
| **–ú–Ω–æ–≥–æ –ª—é–¥–µ–π** | 15 | 90-95% –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π |
| **–•–∞–æ—Å (—Å–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏—è)** | 20 | 85-90% –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π |

---

## üéØ –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏:

### –ê–ª–≥–æ—Ä–∏—Ç–º –≤—ã–±–æ—Ä–∞ –æ–±—ä–µ–∫—Ç–∞:

```python
def pick_swimmer(candidates, prev_bbox):
    scores = []
    
    for candidate in candidates:
        score = 0
        
        # 1. IoU (–ø–µ—Ä–µ–∫—Ä—ã—Ç–∏–µ) - –í–ï–° 10x
        iou = calculate_overlap(prev_bbox, candidate)
        score += iou * 10
        
        # 2. Distance (—Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ) - –í–ï–° 5x
        dist = distance(prev_center, candidate.center)
        score += (1 - dist/150) * 5
        
        # 3. Size similarity - –í–ï–° 3x
        size_sim = size_similarity(prev_bbox, candidate)
        score += size_sim * 3
        
        # 4. Lane - –í–ï–° 2x
        if candidate.lane == target_lane:
            score += 2
        
        # 5. Confidence - –í–ï–° 0.3x
        score += candidate.confidence * 0.3
        
        scores.append((score, candidate))
    
    best_score, best_candidate = max(scores)
    best_iou = calculate_overlap(prev_bbox, best_candidate)
    
    # –ñ–µ—Å—Ç–∫–∏–π –ø–æ—Ä–æ–≥!
    if best_iou < 0.2:
        return prev_bbox  # –ù–ï –ø–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è!
    
    return best_candidate
```

---

## ‚úÖ –ß—Ç–æ —É–ª—É—á—à–∏–ª–æ—Å—å:

| –ü—Ä–æ–±–ª–µ–º–∞ | –î–æ | –ü–æ—Å–ª–µ |
|----------|-----|-------|
| **–ü–µ—Ä–µ—Å–∫–∞–∫–∏–≤–∞–Ω–∏–µ** | 30-50% –∫–∞–¥—Ä–æ–≤ | < 5% –∫–∞–¥—Ä–æ–≤ ‚úÖ |
| **–ü–æ—Ç–µ—Ä—è –ø–ª–æ–≤—Ü–∞** | –ß–∞—Å—Ç–∞—è | –†–µ–¥–∫–∞—è ‚úÖ |
| **–õ–æ–∂–Ω—ã–µ –æ–±—ä–µ–∫—Ç—ã** | –ú–Ω–æ–≥–æ | –ü–æ—á—Ç–∏ –Ω–µ—Ç ‚úÖ |
| **–°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å** | –ù–∏–∑–∫–∞—è | –í—ã—Å–æ–∫–∞—è ‚úÖ |

---

## üéâ –ò—Ç–æ–≥–æ:

**–ó–∞—â–∏—Ç–∞ –æ—Ç –ø–µ—Ä–µ—Å–∫–∞–∫–∏–≤–∞–Ω–∏—è –≤–∫–ª—é—á–∞–µ—Ç:**
- ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω–Ω—ã–µ –≤–µ—Å–∞ IoU –∏ Distance (10x, 5x)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ bbox (3x weight)
- ‚úÖ –ñ–µ—Å—Ç–∫–∏–π –ø–æ—Ä–æ–≥ IoU (0.2 = 20%)
- ‚úÖ –£–º–µ–Ω—å—à–µ–Ω–Ω—ã–π –¥–æ–ø—É—Å—Ç–∏–º—ã–π —Å–¥–≤–∏–≥ (150px)
- ‚úÖ –°–≥–ª–∞–∂–∏–≤–∞–Ω–∏–µ —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–∏ (window=5)
- ‚úÖ FPS –¥–æ 20.0

**–†–∞–±–æ—Ç–∞–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!**

---

## üöÄ –ó–∞–ø—É—Å–∫–∞–π –ø—Ä—è–º–æ —Å–µ–π—á–∞—Å:

```bash
cd /Users/nikita/Downloads/Sprint-Bot-main
python3 -m streamlit run app.py
```

**–¢–µ–ø–µ—Ä—å —Ç—Ä–µ–∫–µ—Ä –Ω–µ –ø–µ—Ä–µ—Å–∫–∞–∫–∏–≤–∞–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏—Ö –ª—é–¥–µ–π!** üéØüèä‚Äç‚ôÇÔ∏è

–î–µ—Ä–∂–∏—Ç —Ü–µ–ª–µ–≤–æ–≥–æ –ø–ª–æ–≤—Ü–∞ –¥–∞–∂–µ –≤ —Ç–æ–ª–ø–µ! üí™‚ú®
